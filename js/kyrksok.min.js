Element.prototype.remove=function(){this.parentElement.removeChild(this)};var kyrksok={endpoint:"https://tools.wmflabs.org/churches",kringla:"http://www.kringla.nu/kringla/objekt?referens=",wikipedia:"https://sv.wikipedia.org/wiki/",commons:"https://commons.wikimedia.org/wiki/",kulturarvsdata:"http://kulturarvsdata.se/",renderChurch:function(e,t){var n=new XMLHttpRequest;n.open("GET",kyrksok.endpoint+"/churches/"+e,!0),n.onreadystatechange=function(){4==n.readyState&&n.status>=200&&n.status<300&&"function"==typeof t&&t(JSON.parse(n.responseText))},n.send()},search:function(e,t){var n=new XMLHttpRequest;n.open("GET",kyrksok.endpoint+"/churches/label?text="+e,!0),n.onreadystatechange=function(){4==n.readyState&&n.status>=200&&n.status<300&&"function"==typeof t&&t(JSON.parse(n.responseText))},n.send()},getUrlParameter:function(e){for(var t=window.location.search.substring(1),n=t.split("&"),r=0;r<n.length;r++){var c=n[r].split("=");if(c[0].toLowerCase()==e.toLowerCase())return c[1]}return!1},createBbrLink:function(e){String.prototype.insertAt=function(e,t){return this.substr(0,e)+t+this.substr(e)};var t=new RegExp("/.[^/]+(|/)$");return insertIndex=t.exec(e).index,kyrksok.kulturarvsdata+e.insertAt(insertIndex,"/html")}},church=kyrksok.getUrlParameter("church");church?(document.getElementById("loading-screen").style.display="block",kyrksok.renderChurch(church,function(e){e.church.length<1&&(window.location="http://kyrksok.se/404.html"),church=e.church[0];var t="mailto:bebyggelseregistret@raa.se?subject=Angående "+church.label+" - via kyrksok.se&body=I kyrkan med id: "+church.kulturarvsdata+" har jag följande att anmärka: ";if(document.title="Kyrksök - "+church.label,document.getElementById("church-title").innerText=church.label,document.getElementById("church-report").setAttribute("href",t),document.getElementById("church-wikipedia").innerText=church.wp_description,document.getElementById("church-wikipedia-link").setAttribute("href",kyrksok.wikipedia+church.wikipedia),document.getElementById("church-kringla").setAttribute("href",kyrksok.kringla+church.kulturarvsdata),document.getElementById("church-bbr-link").setAttribute("href",kyrksok.createBbrLink(church.kulturarvsdata)),""!==church.description?document.getElementById("church-bbr").innerHTML="<p>"+church.description.replace(/(\n)+/g,"</p><p>").replace(/\n/g,"<br>")+"</p>":(document.getElementById("church-bbr").remove(),document.getElementById("bbr-expand").remove(),document.getElementById("bbr-heading").remove()),""!==church.commons?document.getElementById("church-commons").setAttribute("href",kyrksok.commons+"Category:"+church.commons):document.getElementById("church-commons").remove(),document.getElementById("church-header").setAttribute("alt",church.label),document.getElementById("church-header").setAttribute("src",church.image_original),document.getElementById("church-commons-link").setAttribute("href",kyrksok.commons+church.image),document.getElementById("loading-screen").style.display="none",document.getElementById("bbr-expand")){var n=!1;document.getElementById("bbr-expand").addEventListener("click",function(){n?(document.getElementById("church-bbr").style.height="54px",document.getElementById("bbr-expand").innerText="Expandera",document.getElementById("church-report").style.display="none",n=!1):(document.getElementById("church-bbr").style.height="100%",document.getElementById("bbr-expand").innerText="Visa mindre",document.getElementById("church-report").style.display="block",n=!0)})}})):window.location.pathname.indexOf("church.html")!==-1&&(window.location="http://kyrksok.se/404.html"),document.getElementById("search-btn").addEventListener("click",function(){""!==document.getElementById("search-box").value&&kyrksok.search(document.getElementById("search-box").value,function(e){var t="";if(e.churches.length>0)for(i=0;i<e.churches.length;i++){var n=e.churches[i];t=t+'<li><a href="church.html?church='+n.wikidata+'"><div><img src="'+n.image_thumbnail+'"></div><strong>'+n.label+"</strong><p>"+n.wp_description+"</p></a></li>"}else t='<li class="not-found"><strong>Inga kyrkor hittades.</strong><br><button id="search-not-found-btn">OK</button></li>',document.getElementById("results").addEventListener("click",function(e){"search-not-found-btn"===e.target.id&&(document.getElementById("results").style.display="none",document.getElementById("results").innerHTML="")});document.getElementById("results").innerHTML="<ul>"+t+"</ul>",document.getElementById("results").style.display="block"})}),document.getElementById("search-box").addEventListener("keypress",function(e){13==e.keyCode&&document.getElementById("search-btn").click()});